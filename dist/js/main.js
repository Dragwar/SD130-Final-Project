"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}!function(){var n={},i=[];function t(e){if(n[e])return n[e];var t=new Image;t.onload=function(){n[e]=t,s()&&i.forEach(function(e){e()})},n[e]=!1,t.src=e}function s(){var e=!0;for(var t in n)n.hasOwnProperty(t)&&!n[t]&&(e=!1);return e}window.Resources={load:function(e){e instanceof Array?e.forEach(function(e){t(e)}):t(e)},get:function(e){return n[e]},onReady:function(e){i.push(e)},isReady:s}}();var levelCounterTag=document.querySelector("#level-counter"),highestLevelTag=document.querySelector("#highest-level"),livesTag=document.querySelector("#lives"),impossibleMode=document.querySelector("#hard-mode"),moveLeft=-100,moveRight=100,moveUp=-80,moveDown=80,startingXAxis=200,startingYAxis=380,charHeight=80,charWidth=80,offsetX=12,finishZone=-20,userName="Player 1",playerType="char-boy",enemyType="enemy-bug",levelCounter=0,highestLevel=0,hardLevelCounter=1,showHitBox=!1,randNumbBet=function(e,t){return Math.floor(Math.random()*(t-e))+e},resetPlayerPosition=function(e){e.x=startingXAxis,e.y=startingYAxis,console.log(e.name,"Position Reset!")},checkCollisions=function(e,t){livesTag.textContent="Lives: ".concat(e.lives);var n=!0,i=!1,s=void 0;try{for(var a,o=t[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var r=a.value;e.x+offsetX<r.x+offsetX+r.width&&e.x+offsetX+e.width>r.x+offsetX&&e.y<r.y+r.height&&e.height+e.y>r.y&&(1===e.lives?(hardLevelCounter=1,(allEnemies=[]).push(new Enemy(levelCounter=0,60,225,25),new Enemy(100,220,225,25),new Enemy(400,140,225,25)),resetPlayerPosition(e),console.log(allEnemies,"Position Reset!"),e.lives=3,alert("You ran out of lives. Game Reset!"),impossibleMode.style="display:none;"):(resetPlayerPosition(e),console.log(e.name,"has",e.lives,"lives left"),e.lives--),console.log(r.name,"KILLED",e.name))}}catch(e){i=!0,s=e}finally{try{n||null==o.return||o.return()}finally{if(i)throw s}}},toggleHitBoxes=function(e){return showHitBox?ctx.strokeRect(e.x+offsetX,e.y+80,e.width,e.height):ctx.strokeRect(NaN,NaN,charWidth,charHeight)},Enemy=function(){function s(e,t,n,i){_classCallCheck(this,s),this.sprite="./images/".concat(enemyType,".png"),this.name="BUG",this.x=e,this.y=t,this.maxSpeed=n,this.minSpeed=i,this.movement=randNumbBet(n,i),this.width=charWidth,this.height=charHeight}return _createClass(s,[{key:"update",value:function(e){505<this.x&&(this.x=-randNumbBet(500,100)),this.x+=this.movement*e,this.movement<10&&(this.movement=randNumbBet(this.maxSpeed,25)*e,this.x+=this.movement*e)}},{key:"render",value:function(){ctx.drawImage(Resources.get(this.sprite),this.x,this.y),ctx.strokeStyle="red",toggleHitBoxes(this)}}]),s}(),Player=function(){function n(e,t){_classCallCheck(this,n),this.sprite="./images/".concat(e,".png"),this.name=t,this.lives=3,this.x=startingXAxis,this.y=startingYAxis,this.newMove="",this.width=charWidth,this.height=charHeight}return _createClass(n,[{key:"update",value:function(){if(levelCounterTag.textContent="Current Level: ".concat(levelCounter),highestLevelTag.textContent="Highest Level: ".concat(highestLevel),this.y===finishZone)switch(resetPlayerPosition(this),alert("YOU WIN"),allEnemies=[],highestLevel<=++levelCounter&&(highestLevel=levelCounter,highestLevelTag.textContent="Highest Level: ".concat(highestLevel)),levelCounter){case 0:allEnemies.push(new Enemy(0,60,225,125),new Enemy(100,220,225,125),new Enemy(400,140,225,125));break;case 1:allEnemies.push(new Enemy(-20,60,250,150),new Enemy(-100,220,250,150),new Enemy(400,140,250,150));break;case 2:allEnemies.push(new Enemy(200,60,325,225),new Enemy(0,140,425,225),new Enemy(-75,220,275,225));break;case 3:allEnemies.push(new Enemy(-150,60,375,250),new Enemy(400,140,375,250),new Enemy(0,220,500,250));break;case 4:allEnemies.push(new Enemy(400,60,750,350),new Enemy(200,140,500,350),new Enemy(100,220,500,350));break;case 5:alert("FINAL EASY LEVEL\n\nAfter this level you will face endless levels with increased difficulty and\nYou will face double the amount of bugs"),allEnemies.push(new Enemy(0,60,1e3,350),new Enemy(400,140,1e3,350),new Enemy(100,220,1e3,350));break;default:alert("IMPOSSIBLE LEVEL ".concat(hardLevelCounter++)),impossibleMode.style="display:block;",allEnemies.push(new Enemy(randNumbBet(-100,400),60,randNumbBet(100*levelCounter,150),150),new Enemy(randNumbBet(-100,400),140,randNumbBet(100*levelCounter,150),150),new Enemy(randNumbBet(-100,400),220,randNumbBet(100*levelCounter,150),150),new Enemy(randNumbBet(-100,400),60,randNumbBet(100*levelCounter,150),150),new Enemy(randNumbBet(-100,400),140,randNumbBet(100*levelCounter,150),150),new Enemy(randNumbBet(-100,400),220,randNumbBet(100*levelCounter,150),150))}switch(this.newMove){case"left":this.x+=moveLeft;break;case"up":this.y+=moveUp;break;case"right":this.x+=moveRight;break;case"down":this.y+=moveDown}this.newMove=""}},{key:"render",value:function(){ctx.drawImage(Resources.get(this.sprite),this.x,this.y),ctx.strokeStyle="green",toggleHitBoxes(this)}},{key:"handleInput",value:function(e){switch(e){case"left":case"a":100<=this.x&&(this.newMove="left");break;case"up":case"w":0<=this.y&&(this.newMove="up");break;case"right":case"d":this.x<400&&(this.newMove="right");break;case"down":case"s":this.y<380&&(this.newMove="down")}}}]),n}(),allEnemies=[new Enemy(0,60,250,125),new Enemy(100,220,250,125),new Enemy(400,140,250,125)],player=new Player(playerType,userName);document.addEventListener("keyup",function(e){player.handleInput({37:"left",38:"up",39:"right",40:"down",65:"a",68:"d",83:"s",87:"w"}[e.keyCode])}),document.body.addEventListener("keydown",function(e){"Home"===e.key?showHitBox=!showHitBox:"PageDown"===e.key?1<player.lives&&(player.lives-=1):"PageUp"===e.key&&player.lives<3&&(player.lives+=1)});var Engine=function(e){var n,t=e.document,i=e.window,s=t.createElement("canvas"),a=s.getContext("2d");function o(){var t,e=Date.now();t=(e-n)/1e3,allEnemies.forEach(function(e){e.update(t)}),player.update(),checkCollisions(player,allEnemies),function(){var e,t,n=["./images/water-block.png","./images/stone-block.png","./images/stone-block.png","./images/stone-block.png","./images/grass-block.png","./images/grass-block.png"];for(a.clearRect(0,0,s.width,s.height),e=0;e<6;e++)for(t=0;t<5;t++)a.drawImage(Resources.get(n[e]),101*t,83*e);allEnemies.forEach(function(e){e.render()}),player.render()}(),n=e,i.requestAnimationFrame(o)}s.width=505,s.height=606,t.body.appendChild(s),Resources.load(["./images/stone-block.png","./images/water-block.png","./images/grass-block.png","./images/enemy-bug.png","./images/char-boy.png"]),Resources.onReady(function(){alert('\n      Game Rules: (Try pressing the "Home" key to display the hit boxes!)\n      - Get to the water and avoid getting hit by the enemy bugs.\n      - You have 3 lives, when you run out of lives you will restart at the very beginning of the game (level 1)\n      - Every Level before level 5 will be easy, but any level after level 5 will 2 twice as hard.\n      - Try to beat My high-score (level 15). Good Luck!\n      '),n=Date.now(),o()}),e.ctx=a}(void 0);